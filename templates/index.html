{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block nav_items %}
<div class="flex items-center space-x-4">
    <a href="/login" class="text-gray-600 hover:text-gray-900">ãƒ­ã‚°ã‚¤ãƒ³</a>
    <a href="/chat" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹</a>
</div>
{% endblock %}

{% block content %}
<div class="text-center">
    <!-- Hero Section -->
    <div class="max-w-4xl mx-auto py-16 px-4">
        <h1 class="text-4xl font-bold text-gray-900 mb-6">
            ğŸ¥ HealthmateUI ã¸ã‚ˆã†ã“ã
        </h1>
        <p class="text-xl text-gray-600 mb-8">
            AIé§†å‹•ã®åŒ…æ‹¬çš„å¥åº·ç®¡ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ <br>
            ã‚ãªãŸã®å¥åº·ç›®æ¨™é”æˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™
        </p>
        
        <!-- CTA Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
            <a href="/login" 
               class="bg-blue-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-blue-700 transition-colors">
                ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦é–‹å§‹
            </a>
            <a href="/chat" 
               class="border border-blue-600 text-blue-600 px-8 py-3 rounded-lg text-lg font-semibold hover:bg-blue-50 transition-colors">
                ãƒãƒ£ãƒƒãƒˆã‚’è©¦ã™
            </a>
        </div>
    </div>

    <!-- Features Section -->
    <div class="max-w-6xl mx-auto py-16 px-4">
        <h2 class="text-3xl font-bold text-gray-900 mb-12">ä¸»ãªæ©Ÿèƒ½</h2>
        
        <div class="grid md:grid-cols-3 gap-8">
            <!-- AI Health Coach -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <div class="text-4xl mb-4">ğŸ¤–</div>
                <h3 class="text-xl font-semibold text-gray-900 mb-3">AIå¥åº·ã‚³ãƒ¼ãƒ</h3>
                <p class="text-gray-600">
                    ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸå¥åº·ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’24æ™‚é–“ã„ã¤ã§ã‚‚å—ã‘ã‚‰ã‚Œã¾ã™ã€‚
                    ã‚ãªãŸã®å¥åº·ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ãŸæœ€é©ãªææ¡ˆã‚’æä¾›ã—ã¾ã™ã€‚
                </p>
            </div>

            <!-- Health Data Management -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <div class="text-4xl mb-4">ğŸ“Š</div>
                <h3 class="text-xl font-semibold text-gray-900 mb-3">å¥åº·ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h3>
                <p class="text-gray-600">
                    ç›®æ¨™è¨­å®šã€æ´»å‹•è¨˜éŒ²ã€å¥åº·ãƒãƒªã‚·ãƒ¼ã®ç®¡ç†ãªã©ã€
                    åŒ…æ‹¬çš„ãªå¥åº·ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€å…ƒç®¡ç†ã§ãã¾ã™ã€‚
                </p>
            </div>

            <!-- Secure & Private -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <div class="text-4xl mb-4">ğŸ”’</div>
                <h3 class="text-xl font-semibold text-gray-900 mb-3">ã‚»ã‚­ãƒ¥ã‚¢ & ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ</h3>
                <p class="text-gray-600">
                    Amazon Cognitoã«ã‚ˆã‚‹å®‰å…¨ãªèªè¨¼ã¨ã€
                    AWSä¸Šã§ã®æš—å·åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ä¿è­·ã‚’æä¾›ã—ã¾ã™ã€‚
                </p>
            </div>
        </div>
    </div>

    <!-- System Status -->
    <div class="max-w-4xl mx-auto py-8 px-4">
        <div class="bg-gray-50 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹</h3>
            <div 
                hx-get="/api/status"
                hx-trigger="load"
                hx-target="#system-status"
                class="space-y-2">
                <div id="system-status" class="text-gray-600">
                    <div class="animate-pulse">ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã‚’ç¢ºèªä¸­...</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// System status display
document.body.addEventListener('htmx:afterRequest', function(evt) {
    if (evt.detail.target.id === 'system-status') {
        try {
            const response = JSON.parse(evt.detail.xhr.response);
            const statusHtml = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                    <div class="flex items-center">
                        <span class="w-3 h-3 rounded-full ${response.api_status === 'operational' ? 'bg-green-500' : 'bg-red-500'} mr-2"></span>
                        API: ${response.api_status}
                    </div>
                    <div class="flex items-center">
                        <span class="w-3 h-3 rounded-full ${response.cognito_configured ? 'bg-green-500' : 'bg-yellow-500'} mr-2"></span>
                        Cognito: ${response.cognito_configured ? 'è¨­å®šæ¸ˆã¿' : 'æœªè¨­å®š'}
                    </div>
                    <div class="flex items-center">
                        <span class="w-3 h-3 rounded-full ${response.healthcoach_configured ? 'bg-green-500' : 'bg-yellow-500'} mr-2"></span>
                        HealthCoach: ${response.healthcoach_configured ? 'è¨­å®šæ¸ˆã¿' : 'æœªè¨­å®š'}
                    </div>
                </div>
            `;
            evt.detail.target.innerHTML = statusHtml;
        } catch (error) {
            evt.detail.target.innerHTML = '<div class="text-red-600">ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
        }
    }
});

// Auto-redirect if already authenticated
document.addEventListener('DOMContentLoaded', function() {
    // Check authentication status
    fetch('/api/auth/status')
        .then(response => response.json())
        .then(data => {
            if (data.authenticated) {
                // Show notification and redirect
                HealthmateUI.utils.showNotification('æ—¢ã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã§ã™ã€‚ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã€‚', 'info');
                setTimeout(() => {
                    window.location.href = '/chat';
                }, 2000);
            }
        })
        .catch(error => {
            // Ignore authentication check errors
            console.log('Authentication check skipped');
        });
});
</script>
{% endblock %}