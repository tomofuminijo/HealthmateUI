<!-- Enhanced Chat History Template with improved UI -->
{% if messages %}
    {% for message in messages %}
        {% include "chat/components/message_item.html" %}
    {% endfor %}
    
    <!-- Load more messages button (if there are more) -->
    {% if has_more %}
    <div class="text-center py-4">
        <button 
            class="text-blue-600 hover:text-blue-800 text-sm font-medium px-4 py-2 rounded-lg border border-blue-200 hover:bg-blue-50 transition-colors"
            hx-get="/api/chat/history?offset={{ messages|length }}"
            hx-target="#chat-messages"
            hx-swap="afterbegin"
            hx-indicator="#load-more-spinner">
            <span id="load-more-text">さらに読み込む</span>
            <span id="load-more-spinner" class="htmx-indicator ml-2">
                <svg class="animate-spin h-4 w-4" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </span>
        </button>
    </div>
    {% endif %}
    
{% else %}
    {% include "chat/components/welcome_message.html" %}
{% endif %}